<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>GLB модель в Three.js</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>
  <canvas id="scene"></canvas>
<script type="importmap">
{
    "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.module.js"
    }
}
</script>
<script type="module">
    import * as THREE from 'three';
    import { GLTFLoader } from 'https://cdn.jsdelivr.net/npm/three@0.150.1/examples/jsm/loaders/GLTFLoader.js';
    import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.150.1/examples/jsm/controls/OrbitControls.js';
    import { FBXLoader } from 'https://cdn.jsdelivr.net/npm/three@0.150.1/examples/jsm/loaders/FBXLoader.js';
    // =============
    // const scene = new THREE.Scene();
    // scene.background = new THREE.Color(0xf0f0f0);

    // const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
    // camera.position.set(0, 2, 5);

    // const renderer = new THREE.WebGLRenderer({ antialias: true });
    // renderer.setSize(window.innerWidth, window.innerHeight);
    // document.body.appendChild(renderer.domElement);

    // const controls = new OrbitControls(camera, renderer.domElement);
    // controls.enableDamping = true;

    // const light = new THREE.HemisphereLight(0xffffff, 0x444444, 1.2);
    // scene.add(light);

    // const dirLight = new THREE.DirectionalLight(0xffffff, 1);
    // dirLight.position.set(5, 10, 7.5);
    // scene.add(dirLight);

    // // Загрузка FBX модели
    // const loader = new FBXLoader();
    // loader.load('01.fbx', (object) => {
    //     object.scale.set(0.0003, 0.0003, 0.0003); // часто fbx слишком большие
    //     scene.add(object);
    //     animate();
    //     }, undefined, (error) => {
    //     console.error('Ошибка загрузки FBX:', error);
    // });

    // function animate() {
    //     requestAnimationFrame(animate);
    //     controls.update();
    //     renderer.render(scene, camera);
    // }

    // window.addEventListener('resize', () => {
    //     camera.aspect = window.innerWidth / window.innerHeight;
    //     camera.updateProjectionMatrix();
    //     renderer.setSize(window.innerWidth, window.innerHeight);
    // });
    // ========
    // const scene = new THREE.Scene();
    // scene.background = new THREE.Color(0xf0f0f0);

    // const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
    // camera.position.set(0, 2, 5);

    // const renderer = new THREE.WebGLRenderer({ antialias: true });
    // renderer.setSize(window.innerWidth, window.innerHeight);
    // document.body.appendChild(renderer.domElement);

    // const controls = new OrbitControls(camera, renderer.domElement);
    // controls.enableDamping = true;

    // const light = new THREE.HemisphereLight(0xffffff, 0x444444, 1.2);
    // scene.add(light);

    // const dirLight = new THREE.DirectionalLight(0xffffff, 1);
    // dirLight.position.set(5, 10, 7.5);
    // scene.add(dirLight);

    // // Загрузка FBX модели с рёбрами
    // const loader = new FBXLoader();
    // loader.load('01.fbx', (object) => {
    //     object.scale.set(0.0003, 0.0003, 0.0003); // масштаб

    //     object.traverse((child) => {
    //         if (child.isMesh) {
    //             // Создаём обводку рёбер
    //             const edges = new THREE.EdgesGeometry(child.geometry);
    //             const line = new THREE.LineSegments(
    //                 edges,
    //                 new THREE.LineBasicMaterial({ color: 0x000000 }) // цвет рёбер
    //             );
    //             line.position.copy(child.position);
    //             line.rotation.copy(child.rotation);
    //             line.scale.copy(child.scale);

    //             child.add(line); // добавляем обводку внутрь меша
    //         }
    //     });

    //     scene.add(object);
    //     animate();
    // }, undefined, (error) => {
    //     console.error('Ошибка загрузки FBX:', error);
    // });

    // function animate() {
    //     requestAnimationFrame(animate);
    //     controls.update();
    //     renderer.render(scene, camera);
    // }

    // window.addEventListener('resize', () => {
    //     camera.aspect = window.innerWidth / window.innerHeight;
    //     camera.updateProjectionMatrix();
    //     renderer.setSize(window.innerWidth, window.innerHeight);
    // });


    // ========== самыый корректный редзультат
    // const scene = new THREE.Scene();
    // scene.background = new THREE.Color(0xf0f0f0);

    // const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
    // camera.position.set(0, 2, 5);

    // const renderer = new THREE.WebGLRenderer({ antialias: true });
    // renderer.setSize(window.innerWidth, window.innerHeight);
    // document.body.appendChild(renderer.domElement);

    // const controls = new OrbitControls(camera, renderer.domElement);
    // controls.enableDamping = true;

    // const light = new THREE.HemisphereLight(0xffffff, 0xffffff, 1.2);
    // scene.add(light);

    // const dirLight = new THREE.DirectionalLight(0xffffff, 0);
    // dirLight.position.set(5, 10, 5);
    // scene.add(dirLight);

    // // Загрузка FBX модели с рёбрами
    // const loader = new FBXLoader();
    // loader.load('01.fbx', (object) => {
    //     object.scale.set(0.0003, 0.0003, 0.0003); // масштаб

    //     object.traverse((child) => {
    //         if (child.isMesh) {
    //             // Создаём обводку рёбер
    //             const edges = new THREE.EdgesGeometry(child.geometry);
    //             const line = new THREE.LineSegments(
    //                 edges,
    //                 new THREE.LineBasicMaterial({ color: 0x000000 }) // цвет рёбер
    //             );
    //             line.position.copy(child.position);
    //             line.rotation.copy(child.rotation);
    //             line.scale.copy(child.scale);

    //             child.add(line); // добавляем обводку внутрь меша
    //         }
    //     });

    //     scene.add(object);
    //     animate();
    // }, undefined, (error) => {
    //     console.error('Ошибка загрузки FBX:', error);
    // });

    // function animate() {
    //     requestAnimationFrame(animate);
    //     controls.update();
    //     renderer.render(scene, camera);
    // }

    // window.addEventListener('resize', () => {
    //     camera.aspect = window.innerWidth / window.innerHeight;
    //     camera.updateProjectionMatrix();
    //     renderer.setSize(window.innerWidth, window.innerHeight);
    // });
    // ======
    // const scene = new THREE.Scene();
    // scene.background = new THREE.Color(0xf0f0f0);

    // const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
    // camera.position.set(0, 2, 5);

    // const renderer = new THREE.WebGLRenderer({ antialias: true });
    // renderer.setSize(window.innerWidth, window.innerHeight);
    // document.body.appendChild(renderer.domElement);

    // const controls = new OrbitControls(camera, renderer.domElement);
    // controls.enableDamping = true;

    // const light = new THREE.HemisphereLight(0xffffff, 0xffffff, 1.2);
    // scene.add(light);

    // const dirLight = new THREE.DirectionalLight(0xffffff, 1);
    // dirLight.position.set(5, 10, 7.5);
    // scene.add(dirLight);

    // // Загрузка FBX модели с рёбрами
    // const loader = new FBXLoader();
    // loader.load('01.fbx', (object) => {
    // object.scale.set(0.0008, 0.0008, 0.0008);

    // object.traverse((child) => {
    //     if (child.isMesh) {
    //     // Отключаем видимость самого меша
    //     child.visible = true;

    //     // Добавляем только рёбра
    //     const edges = new THREE.EdgesGeometry(child.geometry);

    //     const line = new THREE.LineSegments(
    //         edges,
    //         new THREE.LineBasicMaterial({ color: 0x000000 }) // цвет рёбер
    //     );

    //     line.position.copy(child.position);
    //     line.rotation.copy(child.rotation);
    //     line.scale.copy(child.scale);

    //     scene.add(line); // добавляем только рёбра
    //     }
    // });
    //     animate();
    // }, undefined, (error) => {
    //     console.error('Ошибка загрузки FBX:', error);
    // });

    // function animate() {
    //     requestAnimationFrame(animate);
    //     controls.update();
    //     renderer.render(scene, camera);
    // }

    // window.addEventListener('resize', () => {
    //     camera.aspect = window.innerWidth / window.innerHeight;
    //     camera.updateProjectionMatrix();
    //     renderer.setSize(window.innerWidth, window.innerHeight);
    // });
    // ======= отображения сетки у самой 3д модели
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0xf0f0f0);

    const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(0, 2, 5);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    const light = new THREE.HemisphereLight(0xffffff, 0xffffff, 1.2);
    scene.add(light);

    const dirLight = new THREE.DirectionalLight(0xffffff, 0);
    dirLight.position.set(5, 10, 5);
    scene.add(dirLight);

    // Загрузка FBX модели с рёбрами
    const loader = new FBXLoader();
    loader.load('01.fbx', (object) => {
        object.scale.set(0.0003, 0.0003, 0.0003);

        object.traverse((child) => {
            if (child.isMesh) {
            // Полностью скрываем материал
            child.material.transparent = true;
            child.material.opacity = 0;
            child.material.depthWrite = false;

            // Используем EdgesGeometry, НО на склонированной геометрии (важно!)
            const edges = new THREE.EdgesGeometry(child.geometry.clone(), 30);// 1 — угол резкости
            const line = new THREE.LineSegments(
                edges,
                new THREE.LineBasicMaterial({ color: 0xffffff, linewidth: 1 }) // ← можно усилить цвет/ширину
            );
            // Прикрепляем линию прямо к МЕШУ (чтобы повторяла повороты и масштаб)
            child.add(line);
            }
        });

            scene.add(object);
            animate();
        }, undefined, (error) => {
        console.error('Ошибка загрузки FBX:', error);
    });

    function animate() {
        requestAnimationFrame(animate);
        controls.update();
        renderer.render(scene, camera);
    }

    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
</script>
</body>
</html>
